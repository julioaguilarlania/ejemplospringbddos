CREATE TABLE CLIENTES(
  CLIENTE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  NOMBRE VARCHAR(200) NOT NULL,
  CURP VARCHAR(20) NOT NULL,
  FECHA_REGISTRO DATE
);

CREATE TABLE VEHICULOS (
	PLACAS CHAR(7) PRIMARY KEY,
	CLIENTE_ID INTEGER NOT NULL REFERENCES CLIENTES(CLIENTE_ID),
	COLOR VARCHAR(20),
	MARCA VARCHAR(50),
	MODELO VARCHAR(50),
	KILOMETRAJE NUMERIC(10,2)
);

CREATE TABLE ENTRADAS (
	ENTRADA_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	PLACAS CHAR(7) NOT NULL REFERENCES VEHICULOS(PLACAS),
	FECHA_INGRESO DATETIME,
	FECHA_SALIDA DATETIME,
	ESTATUS VARCHAR(20) NOT NULL
);

CREATE TABLE SERVICIOS(
    SERVICIO_ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	ENTRADA_ID INTEGER NOT NULL REFERENCES ENTRADAS(ENTRADA_ID),
	DESCRIPCION VARCHAR(100) NOT NULL,
	FECHA_INICIO DATETIME,
	FECHA_FIN DATETIME,
	COSTO NUMERIC(10,2)
);

CREATE VIEW TOTALES_POR_MES AS
SELECT DATE_TRUNC(MONTH,FECHA_SALIDA) AS FECHA_SALIDA, COUNT(ENTRADA_ID) AS TOTAL
FROM ENTRADAS
GROUP BY DATE_TRUNC(MONTH,FECHA_SALIDA)
ORDER BY DATE_TRUNC(MONTH,FECHA_SALIDA)